<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">

	<select id="selectBoardList" parameterType="boardgame.fo.board.dto.ReadPageRequestDto"
			resultType="hashmap">
		<include refid="com.pagePrefix"/>
		SELECT
			b.seq,
			b.brdTypeCd,
			b.title,
			cdNm('C009', b.brdTypeCd) AS brdTypeNm,
			IFNULL(DATE_FORMAT(b.insDt, "%Y.%m.%d %H:%i"), '') AS insDt
		FROM
			brd b
		WHERE
			b.brdTypeCd = #{brdTypeCd}
		AND
			b.useYn = 'Y'
		<if test="searchText != null and searchText != ''">
			AND
				(b.title LIKE CONCAT('%',#{searchText},'%')
			OR
				b.cntnts LIKE CONCAT('%',#{searchText},'%'))
		</if>
		<include refid="com.pagePostfix"/>
	</select>

	<select id="selectBoardCount" parameterType="boardgame.fo.board.dto.ReadPageRequestDto" resultType="long">
		SELECT
			COUNT(*) AS cnt
		FROM
			brd b
		WHERE
			b.brdTypeCd = #{brdTypeCd}
		AND
			b.useYn = 'Y'
		<if test="searchText != null and searchText != ''">
			AND
				(b.title LIKE CONCAT('%',#{searchText},'%')
			OR
				b.cntnts LIKE CONCAT('%',#{searchText},'%'))
		</if>
	</select>




	<select id="selectBrdList" parameterType="hashmap" resultType="hashmap">
		<include refid="com.pagingPre"/>
			SELECT
				b.seq,
				b.brdTypeCd,
				b.title,
				cdNm('C009', b.brdTypeCd) AS brdTypeNm,
				IFNULL(DATE_FORMAT(b.insDt, "%Y.%m.%d %H:%i"), '') AS insDt
			FROM
				brd b
			WHERE
				b.brdTypeCd = #{brdTypeCd}
			AND
				b.useYn = 'Y'
			<if test="srchText != null and srchText != ''">
			AND
				(b.title LIKE CONCAT('%',#{srchText},'%')
				OR
				b.cntnts LIKE CONCAT('%',#{srchText},'%'))
			</if>
			ORDER BY
				b.seq DESC
		<include refid="com.pagingPost"/>
	</select>
	
	<select id="selectBrdListCnt" parameterType="hashmap" resultType="hashmap">
			SELECT
				COUNT(*) AS cnt
			FROM
				brd b
			WHERE
				b.brdTypeCd = #{brdTypeCd}
			AND
				b.useYn = 'Y'
			<if test="srchText != null and srchText != ''">
			AND
				(b.title LIKE CONCAT('%',#{srchText},'%')
				OR
				b.cntnts LIKE CONCAT('%',#{srchText},'%'))
			</if>
	</select>
	
	<select id="selectBrd" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT
				b.seq,
				b.brdTypeCd,
				TRIM(b.title) AS title,
				TRIM(b.cntnts) AS cntnts,
				cdNm('C009', b.brdTypeCd) AS brdTypeNm,
				IFNULL(DATE_FORMAT(b.insDt, "%Y.%m.%d %H:%i"), '') AS insDt
			FROM
				brd b
			WHERE
				b.seq = #{seq}
		]]>
	</select>

	<select id="selectMainClubBrdList" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
		SELECT
			cb.seq,
			cb.mmbrNo,
			m.nickNm,
			IFNULL(m.prflImgFileNm, '') AS prflImgFileNm,
			cb.brdTypeCd,
			cdNm('C007', cb.brdTypeCd) AS brdTypeNm,
			cb.title,
			cb.cntnts,
			DATE_FORMAT(cb.insDt, "%Y.%m.%d %H:%i") AS insDt
		FROM
			clubBrd cb,
			mmbr m
		WHERE
			cb.mmbrNo = m.mmbrNo
		  AND
			cb.useYn = 'Y'
		  AND
			m.useYn = 'Y'
		ORDER BY
			cb.seq DESC
			LIMIT 10
		]]>
	</select>

</mapper>
